<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Learn how to use the drugdevelopR package with a hands-on oncological example.
">
<title>Introduction to planning phase II and phase III trials with drugdevelopR • drugdevelopR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to planning phase II and phase III trials with drugdevelopR">
<meta property="og:description" content="Learn how to use the drugdevelopR package with a hands-on oncological example.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">drugdevelopR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Bias_adjustment.html">Methods for Discounting of Phase II Results - Bias Adjustment</a>
    <a class="dropdown-item" href="../articles/Binary_distributed_outcomes.html">Binary Distributed Outcome Variables</a>
    <a class="dropdown-item" href="../articles/Fixed_and_prior_distributions.html">Fixed effects and prior distributions</a>
    <a class="dropdown-item" href="../articles/Interpreting_Output.html">Interpreting the Rest of the Output</a>
    <a class="dropdown-item" href="../articles/More_Parameters.html">More Parameters to Adapt to Specific Settings and Individual Needs</a>
    <a class="dropdown-item" href="../articles/Multiarm_Trials.html">Multiarm - Methods for Multi-Arm Programs</a>
    <a class="dropdown-item" href="../articles/Multiple_Endpoints.html">Multiple_Endpoints</a>
    <a class="dropdown-item" href="../articles/Multitrial.html">Multitrial Programs - Methods for Programs with Several Phase III Trials</a>
    <a class="dropdown-item" href="../articles/Time-to-event_outcomes.html">Time-to-event Outcome Variables</a>
    <a class="dropdown-item" href="../articles/introduction-to-drugdevelopR.html">Introduction to planning phase II and phase III trials with drugdevelopR</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Sterniii3/drugdevelopR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to planning phase II and phase III trials with drugdevelopR</h1>
                        <h4 data-toc-skip class="author">Johannes
Cepicka, Lukas D. Sauer</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Sterniii3/drugdevelopR/blob/HEAD/vignettes/introduction-to-drugdevelopR.Rmd" class="external-link"><code>vignettes/introduction-to-drugdevelopR.Rmd</code></a></small>
      <div class="d-none name"><code>introduction-to-drugdevelopR.Rmd</code></div>
    </div>

    
    
<p>Suppose we are planning a drug development program testing the
superiority of an experimental treatment over a control treatment. Our
drug development program consists of an exploratory phase II trial which
is, in case of promising results, followed by a confirmatory phase III
trial.</p>
<p>The drugdevelopR package enables us to optimally plan such programs
using a utility-maximizing approach. Specifically, it calculates</p>
<ul>
<li>the optimal sample size for phase II and the resulting sample size
for phase III, as well as</li>
<li>the optimal go/no-go decision rule.</li>
</ul>
<p>The decision rule is the optimal threshold for deciding whether we
should proceed to phase III based on the results of phase II.
Optimization is performed with respect to a utility function which takes
the program’s cost, its success probability and its expected benefit
when successfully launching the new drug on the market into account.</p>
<p>But now, let’s get started with a hands-on example.</p>
<div class="section level2">
<h2 id="the-example-setting">The example setting<a class="anchor" aria-label="anchor" href="#the-example-setting"></a>
</h2>
<p>Suppose we are developing a new tumor treatment, <em>exper</em>. The
patient variable that we want to investigate is the difference in tumor
width between the one-year visit and baseline. This is a normally
distributed outcome variable.</p>
<p>Within our drug development program, we will compare our experimental
treatment <em>exper</em> to the control treatment <em>contro</em>.
Building on available data, we expect that the mean tumor difference
amounts to <span class="math inline">\(20±1 \mathrm{mm}\)</span> for
<em>contro</em> and <span class="math inline">\(15±1
\mathrm{mm}\)</span> for <em>exper</em>. Furthermore, the variance is
assumed to be 8. The treatment effect is given as standardized
difference in mean (<span class="math inline">\(\Delta=\frac{\mu_{contro} -
\mu_{exper}}{\sigma}\)</span>). Thus, we obtain a standardized treatment
difference of <span class="math inline">\(\Delta_1 = 0.625\)</span>.</p>
</div>
<div class="section level2">
<h2 id="applying-the-package-to-the-example">Applying the package to the example<a class="anchor" aria-label="anchor" href="#applying-the-package-to-the-example"></a>
</h2>
<p>After installing the package according to the <a href="https://sterniii3.github.io/drugdevelopR/#Installation">installation
instructions</a>, we can load it using the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Sterniii3/drugdevelopR" class="external-link">drugdevelopR</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: mvtnorm</span></span>
<span><span class="co">#&gt; Loading required package: doParallel</span></span>
<span><span class="co">#&gt; Loading required package: foreach</span></span>
<span><span class="co">#&gt; Loading required package: iterators</span></span>
<span><span class="co">#&gt; Loading required package: parallel</span></span>
<span><span class="co">#&gt; Loading required package: msm</span></span>
<span><span class="co">#&gt; Loading required package: cubature</span></span></code></pre></div>
<div class="section level3">
<h3 id="defining-all-necessary-parameters">Defining all necessary parameters<a class="anchor" aria-label="anchor" href="#defining-all-necessary-parameters"></a>
</h3>
<p>In order to apply the package to the setting from our example, we
need to specify the following parameters:</p>
<ul>
<li>
<code>Delta1</code> is the assumed true treatment effect, defined as
the standardized difference in means between the treatment arm and the
control arm. We will use the value <span class="math inline">\(\Delta_1
= 0.625\)</span> as defined above. For now, we will assume that the
treatment effects are fixed and independent of any prior distribution.
Thus, we will set <code>fixed = TRUE</code>.</li>
<li>
<code>n2min</code> and <code>n2max</code> specify the minimal and
maximal number of participants for the phase II trial. The package will
search for the optimal sample size within this region. For now, we want
the program to search for the optimal sample size in the interval
between 20 and 400 participants. In addition, we will tell the program
to search this region in steps of four participants at a time by setting
<code>stepn2 = 4</code>.</li>
<li>
<code>kappamin</code> and <code>kappamax</code> specify the minimal
and maximal threshold value for the go/no-go decision rule. The package
will search for the optimal threshold value within this region. For now,
we want the program to search in the interval between 0.02 and 0.2 while
going in steps of <code>stepkappa = 0.02</code>. Note, that he lower
bound of the decision rule set for represents the smallest size of
treatment effect observed in phase II allowing to go to phase III, so it
can be used to model the minimally clinically relevant effect size.</li>
<li>
<code>c02</code> and <code>c03</code> are fixed costs for phase II
and phase III respectively. We will set the phase II costs to 15 and the
phase III costs to 20 (in <span class="math inline">\(10^5\)</span>$),
i.e we have fixed costs of 1 500 000$ in phase II and 2 000 000$ in
phase III. Note that the currency of the input values does not matter,
so an input value for <code>c02</code> of 15 could also be interpreted
as fixed costs of 1 500 000€ if necessary.</li>
<li>
<code>c2</code> and <code>c3</code> are the costs in phase II and
phase III per patient. We will set them to be 0.675 in phase II and 0.72
in phase III. Again, these values are given in <span class="math inline">\(10^5\)</span>$, i.e we have per patient costs of
67 500$ in phase II and 72 000$ in phase III.</li>
<li>
<code>b1</code>, <code>b2</code> and <code>b3</code> are the
expected small, medium and large benefit categories for successfully
launching the treatment on the market for each effect size category in
<span class="math inline">\(10^5\)</span>$. We will define a small
benefit of 3000, a medium benefit of 8000, and a large benefit of 10000.
The effect size categories directly correspond to the treatment effect,
i.e. if the the treatment effect is between 0 and 0.5 (in standardized
differences of mean) we have a small treatment effect, hence yielding
expected benefits of the drug development program of 300 000 000$.</li>
<li>
<code>alpha</code> is the specified significance level. We will set
<code>alpha = 0.05</code>.</li>
<li>1 - <code>beta</code> is the minimal power that we require for our
drug development program. We will set <code>beta = 0.1</code>, meaning
that we require a power of 90%.</li>
<li>Further parameters: In more advanced settings, we would need to
pre-specify even more parameters. For now, we can set all remaining
parameters to <code>NULL</code>. Their use is explained in the <a href="https://sterniii3.github.io/drugdevelopR/articles/More_Parameters.html">vignette
on parameters</a> and in the <a href="https://sterniii3.github.io/drugdevelopR/articles/Fixed_and_prior_distributions.html">vigentte
on prior distributions</a>.</li>
</ul>
<p>Now that we have defined all parameters needed for our example, we
are ready to feed them to the package. We will use the function
<code><a href="../reference/optimal_normal.html">optimal_normal()</a></code>, which calculates the optimal sample size
and the optimal threshold value for a normally distributed outcome
variable.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimal_normal.html">optimal_normal</a></span><span class="op">(</span>Delta1 <span class="op">=</span> <span class="fl">0.625</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># treatment effect</span></span>
<span>                       n2min <span class="op">=</span> <span class="fl">20</span>, n2max <span class="op">=</span> <span class="fl">400</span>, <span class="co"># sample size region</span></span>
<span>                       stepn2 <span class="op">=</span> <span class="fl">4</span>, <span class="co"># sample size step size</span></span>
<span>                       kappamin <span class="op">=</span> <span class="fl">0.02</span>, kappamax <span class="op">=</span> <span class="fl">0.2</span>, <span class="co"># threshold region</span></span>
<span>                       stepkappa <span class="op">=</span> <span class="fl">0.02</span>, <span class="co"># threshold step size</span></span>
<span>                       c2 <span class="op">=</span> <span class="fl">0.675</span>, c3 <span class="op">=</span> <span class="fl">0.72</span>, <span class="co"># maximal total trial costs</span></span>
<span>                       c02 <span class="op">=</span> <span class="fl">15</span>, c03 <span class="op">=</span> <span class="fl">20</span>, <span class="co"># maximal per-patient costs</span></span>
<span>                       b1 <span class="op">=</span> <span class="fl">3000</span>, b2 <span class="op">=</span> <span class="fl">8000</span>, b3 <span class="op">=</span> <span class="fl">10000</span>, <span class="co"># gains for patients</span></span>
<span>                       alpha <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># significance level</span></span>
<span>                       beta <span class="op">=</span> <span class="fl">0.1</span>, <span class="co"># 1 - power</span></span>
<span>                       Delta2 <span class="op">=</span> <span class="cn">NULL</span>, w <span class="op">=</span> <span class="cn">NULL</span>, in1 <span class="op">=</span> <span class="cn">NULL</span>, in2 <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                       a <span class="op">=</span> <span class="cn">NULL</span>,b <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="co"># setting all unneeded parameters to NULL</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interpreting-the-output">Interpreting the output<a class="anchor" aria-label="anchor" href="#interpreting-the-output"></a>
</h3>
<p>After setting all these input parameters and running the function,
let’s take a look at the output of the program.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span></span>
<span><span class="co">#&gt;         u Kappa n2  n3   n pgo sProg Delta   K K2  K3 sProg1 sProg2 sProg3</span></span>
<span><span class="co">#&gt; 1 3259.83  0.06 84 166 250   1  0.85 0.625 Inf 72 139   0.68   0.17   0.01</span></span>
<span><span class="co">#&gt;   steps1 stepm1 stepl1 alpha beta c02 c03    c2   c3   b1   b2    b3 gamma</span></span>
<span><span class="co">#&gt; 1      0    0.5    0.8  0.05  0.1  15  20 0.675 0.72 3000 8000 10000     0</span></span></code></pre></div>
<p>The program returns a total of thirteen values and the input values.
For now, we will only look at the most important ones:</p>
<ul>
<li>
<code>res$n2</code> is the optimal sample size for phase II and
<code>res$n3</code> the resulting sample size for phase III. We see that
the optimal scenario requires 84 participants in phase II and 166
participants in phase III.</li>
<li>
<code>res$Kappa</code> is the optimal threshold value for the
go/no-go decision rule. We see that we need a treatment effect of more
than 0.06 in phase II in order to proceed to phase III.</li>
<li>
<code>res$u</code> is the expected utility of the program for the
optimal sample size and threshold value. In our case it amounts to
3259.83, i.e we have an expected utility of 325 983 000$.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="where-to-go-from-here">Where to go from here<a class="anchor" aria-label="anchor" href="#where-to-go-from-here"></a>
</h2>
<p>This tutorial only covered drugdevelopR’s basic setting. Luckily, the
package’s functionality extends to a multitude of different settings. If
the example above doesn’t suit your needs, you can adapt it to your
specific setting:</p>
<ul>
<li>
<em>Different outcomes:</em> Apply it to <a href="https://sterniii3.github.io/drugdevelopR/articles/Binary_distributed_outcomes.html">binary
endpoints</a> and <a href="https://sterniii3.github.io/drugdevelopR/articles/Time-to-event_outcomes.html">time-to-event
endpoints</a>.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/Interpreting_Output.html"><em>Interpreting
the rest of the output:</em></a> Obtain further details on your drug
development program.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/Fixed_and_prior_distributions.html"><em>Fixed
or prior:</em></a> Model the assumed treatment effect on a prior
distribution.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/More_Parameters.html"><em>More
parameters:</em></a> Define custom effect size categories. Put
constraints on the optimization by defining maximum costs, the total
expected sample size of the program or the minimum expected probability
of a successful program. Define an expected difference in treatment
effect between phase II and III. Skip phase II.</li>
<li>
<em>Complex drug development programs:</em> Adapt to situations with
<a href="https://sterniii3.github.io/drugdevelopR/articles/Bias_adjustment.html">biased
effect estimators</a>, <a href="https://sterniii3.github.io/drugdevelopR/articles/Multitrial.html">multiple
phase III trials</a>, <a href="https://sterniii3.github.io/drugdevelopR/articles/Multiarm_Trials.html">multi-arm
trials</a>, or multiple endpoints.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/More_Parameters.html"><em>Parallel
computing:</em></a> Be faster at calculating the optimum by using
parallel computing.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Stella Preussler.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

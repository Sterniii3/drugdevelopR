<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Bias adjustment - methods for discounting of phase II results • drugdevelopR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bias adjustment - methods for discounting of phase II results">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">drugdevelopR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Introduction-to-drugdevelopR.html">Introduction to planning phase II and phase III trials with drugdevelopR</a></li>
    <li><a class="dropdown-item" href="../articles/Package_validation.html">Package validation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Sterniii3/drugdevelopR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bias adjustment - methods for discounting of phase II results</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Sterniii3/drugdevelopR/blob/master/vignettes/Bias_adjustment.Rmd" class="external-link"><code>vignettes/Bias_adjustment.Rmd</code></a></small>
      <div class="d-none name"><code>Bias_adjustment.Rmd</code></div>
    </div>

    
    
<p>Suppose we are planning a drug development program testing the
superiority of an experimental treatment over a control treatment. Our
drug development program consists of an exploratory phase II trial which
is, in case of promising results, followed by a confirmatory phase III
trial.</p>
<p>The drugdevelopR package enables us to optimally plan such programs
using a utility-maximizing approach. To get a brief introduction, we
presented a very basic example on how the package works in <a href="https://sterniii3.github.io/drugdevelopR/articles/Introduction-to-drugdevelopR.html">Introduction
to planning phase II and phase III trials with drugdevelopR</a>.
Contrary to the introduction we now want to investigate a scenario,
where the results of phase II of a time-to-event outcome are discounted.
The discounting may be necessary as programs that proceed to phase III
can be overoptimistic about the treatment effect (i.e. they are biased).
Hereby, we adjust the optimal number of events in phase III.</p>
<div class="section level2">
<h2 id="the-example-setting">The example setting<a class="anchor" aria-label="anchor" href="#the-example-setting"></a>
</h2>
<p>Suppose we are developing a new tumor treatment, <em>exper</em>. The
patient variable that we want to investigate is how long the patient
survives without further progression of the tumor (progression-free
survival). This is a time-to-event outcome variable. Therefore, we will
use the function <code>optimal_bias</code>, which calculates optimal
sample sizes and threshold decisions values for time-to-event outcomes
with bias adjustment.</p>
<p>Within our drug development program, we will compare our experimental
treatment <em>exper</em> to the control treatment <em>contro</em>. The
treatment effect measure is given by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>H</mi><mi>R</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta = −\log(HR)</annotation></semantics></math>,
which is the negative logarithm of the hazard ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">HR</annotation></semantics></math>,
which is the ratio of the hazard rates. If we assume that unfavorable
events as tumor progression occur only 75% as often as in the control
group, we have a hazard ratio of 0.75.</p>
</div>
<div class="section level2">
<h2 id="applying-the-package-to-the-example">Applying the package to the example<a class="anchor" aria-label="anchor" href="#applying-the-package-to-the-example"></a>
</h2>
<p>After installing the package according to the <a href="https://sterniii3.github.io/drugdevelopR/#Installation">installation
instructions</a>, we can load it using the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Sterniii3/drugdevelopR" class="external-link">drugdevelopR</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: doParallel</span></span>
<span><span class="co">#&gt; Loading required package: foreach</span></span>
<span><span class="co">#&gt; Loading required package: iterators</span></span>
<span><span class="co">#&gt; Loading required package: parallel</span></span></code></pre></div>
<p>We insert the same input values as in the example for <a href="https://sterniii3.github.io/drugdevelopR/articles/Time-to-event_outcomes.html">time-to-event
endpoints</a>. As in the basic setting, the treatment effect may be
fixed (as in this example) or follows a prior distribution (see <a href="https://sterniii3.github.io/drugdevelopR/articles/Fixed_and_prior_distributions.html">Fixed
or Prior</a>). Furthermore, most options to adapt the program to your
specific needs are also available in this setting (see <a href="https://sterniii3.github.io/drugdevelopR/articles/More_Parameters.html">More
parameters</a>), however skipping phase II and choosing different
treatment effects in phase II and III are not possible.</p>
<p>In addition to the parameters from the basic setting, some parameters
are needed specifically for the bias adjustment:</p>
<ul>
<li>The parameter <code>adj</code> is needed to select the type of bias
adjustment. There are four possible options for this parameter:
<ul>
<li>
<code>adj = "additive"</code> selects the additive adjustment method
for the number of events in phase III. Here, the lower bound of the
one-sided confidence interval is adjusted according to Wang et al
(2006).</li>
<li>
<code>adj = "multiplicative"</code> selects the multiplicative
adjustment method for the number of events in phase III. Here, an
estimate with a retention factor is used according to Kirby et
al. (2012).</li>
<li>
<code>adj = "both"</code> returns the results of both adjustment
methods, i.e. the additive and the multiplicative one.</li>
<li>
<code>adj = "all"</code> returns the results of both adjustment
methods and in addition, also returns the results for both methods when
not only the number of events is adjusted but also the threshold value
for the decision rule.</li>
</ul>
</li>
<li>Furthermore, the optimization regions for the adjustment parameters
have to be specified.
<ul>
<li>For the additive method, no adjustment is equal to setting the
adjustment parameter to 0.5. Therefore we set the upper limit
<code>alphaCImax</code> to 0.5. We want to investigate the optimization
region in the interval of [0.1, 0.5] with step size 0.05. Thus, we set
the lower bound to <code>alphaCImin</code> to 0.1 and the step size to
<code>stepalphaCI = 0.05</code>.</li>
<li>For the multiplicative method, no adjustment is equal to setting the
adjustment parameter to 1. Therefore we set the upper limit
<code>lambdamax</code> to 1. We want to investigate the optimization
region in the interval of [0.7, 1] with step size 0.05. Thus, we set the
lower bound to <code>lambdamin</code> to 0.1 and the step size to
<code>steplambda = 0.05</code>.</li>
</ul>
</li>
</ul>
<p>Now that we have defined all parameters needed for our example, we
are ready to feed them to the package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimal_bias.html">optimal_bias</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">0.3</span>,                                 <span class="co"># define parameters for prior</span></span>
<span>   hr1 <span class="op">=</span> <span class="fl">0.75</span>, hr2 <span class="op">=</span> <span class="fl">0.8</span>, id1 <span class="op">=</span> <span class="fl">210</span>, id2 <span class="op">=</span> <span class="fl">420</span>,              <span class="co"># (https://web.imbi.uni-heidelberg.de/prior/)</span></span>
<span>   d2min <span class="op">=</span> <span class="fl">20</span>, d2max <span class="op">=</span> <span class="fl">400</span>, stepd2 <span class="op">=</span> <span class="fl">5</span>,                      <span class="co"># define optimization set for d2</span></span>
<span>   adj <span class="op">=</span> <span class="st">"both"</span>,                                             <span class="co"># choose both adjustment methods</span></span>
<span>   lambdamin <span class="op">=</span> <span class="fl">0.7</span>, lambdamax <span class="op">=</span> <span class="fl">1</span>, steplambda <span class="op">=</span> <span class="fl">0.05</span>,        <span class="co"># optimization set for multiplicative adjustment</span></span>
<span>   alphaCImin <span class="op">=</span> <span class="fl">0.1</span>, alphaCImax <span class="op">=</span> <span class="fl">0.5</span>, stepalphaCI <span class="op">=</span> <span class="fl">0.05</span>,   <span class="co"># optimization set for additive adjustment</span></span>
<span>   hrgomin <span class="op">=</span> <span class="fl">0.7</span>, hrgomax <span class="op">=</span> <span class="fl">0.9</span>, stephrgo <span class="op">=</span> <span class="fl">0.01</span>,            <span class="co"># define optimization set for HRgo</span></span>
<span>   alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.1</span>, xi2 <span class="op">=</span> <span class="fl">0.7</span>, xi3 <span class="op">=</span> <span class="fl">0.7</span>,          <span class="co"># drug development planning parameters</span></span>
<span>   c2 <span class="op">=</span> <span class="fl">0.75</span>, c3 <span class="op">=</span> <span class="fl">1</span>, c02 <span class="op">=</span> <span class="fl">100</span>, c03 <span class="op">=</span> <span class="fl">150</span>,                  <span class="co"># define fixed and variable costs</span></span>
<span>   K <span class="op">=</span> <span class="cn">Inf</span>, N <span class="op">=</span> <span class="cn">Inf</span>, S <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,                               <span class="co"># set constraints</span></span>
<span>   steps1 <span class="op">=</span> <span class="fl">1</span>,  stepm1 <span class="op">=</span> <span class="fl">0.95</span>, stepl1 <span class="op">=</span> <span class="fl">0.85</span>,                <span class="co"># define boundary for  effect size categories</span></span>
<span>   b1 <span class="op">=</span> <span class="fl">1000</span>, b2 <span class="op">=</span> <span class="fl">2000</span>, b3 <span class="op">=</span> <span class="fl">3000</span>,                          <span class="co"># define expected benefits</span></span>
<span>   fixed <span class="op">=</span> <span class="cn">TRUE</span>,                                             <span class="co"># choose if  effects are fixed or random</span></span>
<span>   num_cl <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="interpreting-the-output">Interpreting the output<a class="anchor" aria-label="anchor" href="#interpreting-the-output"></a>
</h3>
<p>After setting all these input parameters and running the function,
let’s take a look at the output of the program.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span></span>
<span><span class="co">#&gt; Optimization result with multiplicative adjustment of the treatment effect:</span></span>
<span><span class="co">#&gt;  Utility: 378.47</span></span>
<span><span class="co">#&gt;  Bias adjustment parameter: 0.95</span></span>
<span><span class="co">#&gt;  Sample size:</span></span>
<span><span class="co">#&gt;    phase II: 236, phase III: 624, total: 860</span></span>
<span><span class="co">#&gt;  Expected number of events:</span></span>
<span><span class="co">#&gt;    phase II: 165, phase III: 436, total: 601</span></span>
<span><span class="co">#&gt;  Assumed event rate:</span></span>
<span><span class="co">#&gt;    phase II: 0.7, phase III: 0.7</span></span>
<span><span class="co">#&gt;  Probability to go to phase III: 0.79</span></span>
<span><span class="co">#&gt;  Total cost:</span></span>
<span><span class="co">#&gt;    phase II: 277, phase III: 742, cost constraint: Inf</span></span>
<span><span class="co">#&gt;  Fixed cost:</span></span>
<span><span class="co">#&gt;    phase II: 100, phase III: 150</span></span>
<span><span class="co">#&gt;  Variable cost per patient:</span></span>
<span><span class="co">#&gt;    phase II: 0.75, phase III: 1</span></span>
<span><span class="co">#&gt;  Effect size categories (expected gains):</span></span>
<span><span class="co">#&gt;   small: 1 (1000), medium: 0.95 (2000), large: 0.85 (3000)</span></span>
<span><span class="co">#&gt;  Success probability: 0.63</span></span>
<span><span class="co">#&gt;  Joint probability of success and observed effect of size ... in phase III:</span></span>
<span><span class="co">#&gt;    small: 0.09, medium: 0.3, large: 0.24</span></span>
<span><span class="co">#&gt;  Significance level: 0.025</span></span>
<span><span class="co">#&gt;  Targeted power: 0.9</span></span>
<span><span class="co">#&gt;  Decision rule threshold: 0.85 [HRgo] </span></span>
<span><span class="co">#&gt;  Assumed true effect: 0.75 [hr] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Optimization result with additive adjustment of the treatment effect:</span></span>
<span><span class="co">#&gt;  Utility: 377.1</span></span>
<span><span class="co">#&gt;  Bias adjustment parameter: 0.5</span></span>
<span><span class="co">#&gt;  Sample size:</span></span>
<span><span class="co">#&gt;    phase II: 236, phase III: 614, total: 850</span></span>
<span><span class="co">#&gt;  Expected number of events:</span></span>
<span><span class="co">#&gt;    phase II: 165, phase III: 430, total: 595</span></span>
<span><span class="co">#&gt;  Assumed event rate:</span></span>
<span><span class="co">#&gt;    phase II: 0.7, phase III: 0.7</span></span>
<span><span class="co">#&gt;  Probability to go to phase III: 0.81</span></span>
<span><span class="co">#&gt;  Total cost:</span></span>
<span><span class="co">#&gt;    phase II: 277, phase III: 736, cost constraint: Inf</span></span>
<span><span class="co">#&gt;  Fixed cost:</span></span>
<span><span class="co">#&gt;    phase II: 100, phase III: 150</span></span>
<span><span class="co">#&gt;  Variable cost per patient:</span></span>
<span><span class="co">#&gt;    phase II: 0.75, phase III: 1</span></span>
<span><span class="co">#&gt;  Effect size categories (expected gains):</span></span>
<span><span class="co">#&gt;   small: 1 (1000), medium: 0.95 (2000), large: 0.85 (3000)</span></span>
<span><span class="co">#&gt;  Success probability: 0.62</span></span>
<span><span class="co">#&gt;  Joint probability of success and observed effect of size ... in phase III:</span></span>
<span><span class="co">#&gt;    small: 0.09, medium: 0.29, large: 0.24</span></span>
<span><span class="co">#&gt;  Significance level: 0.025</span></span>
<span><span class="co">#&gt;  Targeted power: 0.9</span></span>
<span><span class="co">#&gt;  Decision rule threshold: 0.86 [HRgo] </span></span>
<span><span class="co">#&gt;  Assumed true effect: 0.75 [hr]</span></span></code></pre></div>
<p>The program returns output values for both adjustment methods. The
most important ones for the multiplicative method are:</p>
<ul>
<li>
<code>res[1,]$Adj</code> is the optimal multiplicative adjustment
parameter. In this setting, our optimal value is 0.95, indicating that a
slight bias adjustment leads to a higher utility.</li>
<li>
<code>res[1,]$d2</code> is the optimal number of events for phase II
and <code>res$d3</code> the resulting number of events for phase III. We
see that the optimal scenario requires 165 events in phase II and 436
events in phase III, which correspond to 236 participants in phase II
and 624 in phase III.</li>
<li>
<code>res[1,]$HRgo</code> is the optimal threshold value for the
go/no-go decision rule. We see that we need a hazard ratio of less than
0.85 in phase II in order to proceed to phase III.</li>
<li>
<code>res[1,]$u</code> is the expected utility of the program for
the optimal sample size and threshold value. In our case it amounts to
378.47, i.e. we have an expected utility of 37 847 000$.</li>
</ul>
<p>For the additive method we get:</p>
<ul>
<li>
<code>res[2,]$Adj</code> is the optimal additive adjustment
parameter. In this setting, our optimal value is 0.5, indicating that no
bias adjustment leads to the highest utility. In this case, our results
match the results of the basic setting as can be verified <a href="https://sterniii3.github.io/drugdevelopR/articles/Time-to-event_outcomes.html">here</a>.</li>
<li>
<code>res[2,]$d2</code> is the optimal number of events for phase II
and <code>res$d3</code> the resulting number of events for phase III. We
see that the optimal scenario requires 165 events in phase II and 430
events in phase III, which correspond to 236 participants in phase II
and 614 in phase III.</li>
<li>
<code>res[2,]$HRgo</code> is the optimal threshold value for the
go/no-go decision rule. We see that we need a hazard ratio of less than
0.86 in phase II in order to proceed to phase III.</li>
<li>
<code>res[2,]$u</code> is the expected utility of the program for
the optimal sample size and threshold value. In our case it amounts to
377.1, i.e. we have an expected utility of 37 710 000$.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="where-to-go-from-here">Where to go from here<a class="anchor" aria-label="anchor" href="#where-to-go-from-here"></a>
</h2>
<p>In this article we presented an example how methods to discount the
results of phase II can be included for the purpose of bias adjustment.
Note that this example is not restricted to time-to-event endpoints but
can also be applied to binary and normally distributed endpoints using
the functions <code>optimal_bias_binary</code> and
<code>optimal_bias_normal</code>. For more information on how to use the
package, see:</p>
<ul>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/Introduction-to-drugdevelopR.html"><em>Introduction
to drugdevelopR:</em></a> See how the package works in a basic
example.</li>
<li>
<em>Different outcomes:</em> Apply it to <a href="https://sterniii3.github.io/drugdevelopR/articles/Binary_outcomes.html">binary
endpoints</a> and <a href="https://sterniii3.github.io/drugdevelopR/articles/Time-to-event_outcomes.html">time-to-event
endpoints</a>.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/Interpreting_Output.html"><em>Interpreting
the rest of the output:</em></a> Obtain further details on your drug
development program.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/Fixed_and_prior_distributions.html"><em>Fixed
or prior:</em></a> Model the assumed treatment effect on a prior
distribution.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/More_Parameters.html"><em>More
parameters:</em></a> Define custom effect size categories. Put
constraints on the optimization by defining maximum costs, the total
expected sample size of the program or the minimum expected probability
of a successful program. Define an expected difference in treatment
effect between phase II and III. Skip phase II.</li>
<li>
<em>Complex drug development programs:</em> Adapt to situations with
<a href="https://sterniii3.github.io/drugdevelopR/articles/Multitrial.html">multiple
phase III trials</a>, <a href="https://sterniii3.github.io/drugdevelopR/articles/Multiarm_Trials.html">multi-arm
trials</a>, or <a href="https://sterniii3.github.io/drugdevelopR/articles/Multiple_Endpoints.html">multiple
endpoints</a>.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/More_Parameters.html#parallel-computing"><em>Parallel
computing:</em></a> Be faster at calculating the optimum by using
parallel computing.</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Kirby, S., Burke, J., Chuang-Stein, C., and Sin, C. (2012).
Discounting phase 2 results when planning phase 3 clinical trials.
Pharmaceutical Statistics, 11(5):373–385.</p>
<p>Wang, S.-J., Hung, H. J., and O’Neill, R. T. (2006). Adapting the
sample size planning of a phase III trial based on phase II data.
Pharmaceutical Statistics, 5(2):85–97.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stella Erdmann, Johannes Cepicka, Marietta Kirchner, Meinhard Kieser, Lukas D. Sauer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>

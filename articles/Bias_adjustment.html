<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="drugdevelopR">
<title>Methods for Discounting of Phase II Results - Bias Adjustment • drugdevelopR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Methods for Discounting of Phase II Results - Bias Adjustment">
<meta property="og:description" content="drugdevelopR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">drugdevelopR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Bias_adjustment.html">Methods for Discounting of Phase II Results - Bias Adjustment</a>
    <a class="dropdown-item" href="../articles/Binary_distributed_outcomes.html">Binary Distributed Outcome Variables</a>
    <a class="dropdown-item" href="../articles/Fixed_and_prior_distributions.html">Fixed effects and prior distributions</a>
    <a class="dropdown-item" href="../articles/Interpreting_Output.html">Interpreting the Rest of the Output</a>
    <a class="dropdown-item" href="../articles/More_Parameters.html">More Parameters to Adapt to Specific Settings and Individual Needs</a>
    <a class="dropdown-item" href="../articles/Multiarm_Trials.html">Multiarm - Methods for Multi-Arm Programs</a>
    <a class="dropdown-item" href="../articles/Multiple_Endpoints.html">Multiple_Endpoints</a>
    <a class="dropdown-item" href="../articles/Multitrial.html">Multitrial Programs - Methods for Programs with Several Phase III Trials</a>
    <a class="dropdown-item" href="../articles/Time-to-event_outcomes.html">Time-to-event Outcome Variables</a>
    <a class="dropdown-item" href="../articles/introduction-to-drugdevelopR.html">Introduction to planning phase II and phase III trials with drugdevelopR</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Sterniii3/drugdevelopR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Methods for Discounting of Phase II Results - Bias Adjustment</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Sterniii3/drugdevelopR/blob/HEAD/vignettes/Bias_adjustment.Rmd" class="external-link"><code>vignettes/Bias_adjustment.Rmd</code></a></small>
      <div class="d-none name"><code>Bias_adjustment.Rmd</code></div>
    </div>

    
    
<p>Suppose we are planning a drug development program testing the
superiority of an experimental treatment over a control treatment. Our
drug development program consists of an exploratory phase II trial which
is, in case of promising results, followed by a confirmatory phase III
trial.</p>
<p>The drugdevelopR package enables us to optimally plan such programs
using a utility-maximizing approach. To get a brief introduction, we
presented a very basic example on how the package works in <a href="https://sterniii3.github.io/drugdevelopR/articles/introduction-to-drugdevelopR.html">Introduction
to planning phase II and phase III trials with drugdevelopR</a>.
Contrary to the introduction we now want to investigate a scenario,
where the results of phase II of a time-to-event outcome are discounted.
The discounting may be necessary as programs that proceed to phase III
can be overoptimistic about the treatment effect (i.e. they are biased).
Hereby, we adjust the optimal number of events in phase III.</p>
<div class="section level2">
<h2 id="the-example-setting">The example setting<a class="anchor" aria-label="anchor" href="#the-example-setting"></a>
</h2>
<p>Suppose we are developing a new tumor treatment, <em>exper</em>. The
patient variable that we want to investigate is how long the patient
survives without further progression of the tumor (progression free
survival). This is a time to event outcome variable. Therefore, we will
use the function <code>optimal_bias</code>, which calculates optimal
sample sizes and threshold decisions values for time-to-event outcomes
with bias adjustment.</p>
<p>Within our drug development program, we will compare our experimental
treatment <em>exper</em> to the control treatment <em>contro</em>. The
treatment effect measure is given by <span class="math inline">\(\theta
= −\log(HR)\)</span>, which is the negative logarithm of the hazard
ratio <span class="math inline">\(HR\)</span>, which is the ratio of the
hazard rates. If we assume that unfavorable events as tumor progression
occur only 75% as often as in the control group, we have a hazard ratio
of 0.75.</p>
</div>
<div class="section level2">
<h2 id="applying-the-package-to-the-example">Applying the package to the example<a class="anchor" aria-label="anchor" href="#applying-the-package-to-the-example"></a>
</h2>
<p>After installing the package according to the <a href="https://sterniii3.github.io/drugdevelopR/#Installation">installation
instructions</a>, we can load it using the following code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Sterniii3/drugdevelopR" class="external-link">drugdevelopR</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: mvtnorm</span></span>
<span><span class="co">#&gt; Loading required package: doParallel</span></span>
<span><span class="co">#&gt; Loading required package: foreach</span></span>
<span><span class="co">#&gt; Loading required package: iterators</span></span>
<span><span class="co">#&gt; Loading required package: parallel</span></span>
<span><span class="co">#&gt; Loading required package: msm</span></span>
<span><span class="co">#&gt; Loading required package: cubature</span></span></code></pre></div>
<p>We insert the same input values as in the example for time-to-event
outcomes (see the vignette on <a href="https://sterniii3.github.io/drugdevelopR/articles/Time-to-event_outcomes.html">time-to-event
endpoints</a>). As in the basic setting, the treatment effect may be
fixed (as in this example) or follows a prior distribution (see <a href="https://sterniii3.github.io/drugdevelopR/articles/Fixed_and_prior_distributions.html">Fixed
or Prior</a>). Furthermore, most options to adapt the program to your
specific needs are also available in this setting (see <a href="https://sterniii3.github.io/drugdevelopR/articles/More_Parameters.html">More
Paramters</a>), however skipping phase II and choosing different
treatment effects in phase II and III are not possible.</p>
<p>In addition to the parameters from the basic setting, some parameters
are needed specifically for the bias adjustment:</p>
<ul>
<li>The parameter <code>adj</code> is needed to select the type of bias
adjustment. There are four possible options for this parameter:
<ul>
<li>
<code>adj = additive</code> selects the additive adjustment method
for the number of events in phase III. Hereby, the lower bound of the
one-sided confidence interval is adjusted according to Wang et al
(2006).</li>
<li>
<code>adj = multiplicative</code> selects the multiplicative
adjustment method for the number of events in phase III. Hereby, an
estimate with a retention factor is used according to Kirby et
al. (2012).</li>
<li>
<code>adj = both</code> returns the results of both adjustment
methods, i.e. the additive and the multiplicative one.</li>
<li>
<code>adj = all</code> returns the results of both adjustment
methods and in addition, also returns the results for both methods when
not only the number of events is adjusted but also the threshold value
for the decision rule.</li>
</ul>
</li>
<li>Furthermore, the optimization regions for the adjustment parameters
have to be specified.
<ul>
<li>For the additive method, no adjustment is equal to setting the
adjustment parameter to 0.5. Therefore we set the upper limit
<code>alphaCImax</code> to 0.5. We want to investigate the optimization
region in the interval of [0.1, 0.5] with step size 0.05. Thus, we set
the lower bound to <code>alphaCImin</code> to 0.1 and the step size to
<code>stepalphaCI = 0.05</code>.</li>
<li>For the multiplicative method, no adjustment is equal to setting the
adjustment parameter to 1. Therefore we set the upper limit
<code>lambdamax</code> to 1. We want to investigate the optimization
region in the interval of [0.7, 1] with step size 0.05. Thus, we set the
lower bound to <code>lambdamin</code> to 0.1 and the step size to
<code>steplambda = 0.05</code>.</li>
</ul>
</li>
</ul>
<p>Now that we have defined all parameters needed for our example, we
are ready to feed them to the package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimal_bias.html">optimal_bias</a></span><span class="op">(</span>w <span class="op">=</span> <span class="fl">0.3</span>,                                 <span class="co"># define parameters for prior</span></span>
<span>   hr1 <span class="op">=</span> <span class="fl">0.75</span>, hr2 <span class="op">=</span> <span class="fl">0.8</span>, id1 <span class="op">=</span> <span class="fl">210</span>, id2 <span class="op">=</span> <span class="fl">420</span>,              <span class="co"># (https://web.imbi.uni-heidelberg.de/prior/)</span></span>
<span>   d2min <span class="op">=</span> <span class="fl">20</span>, d2max <span class="op">=</span> <span class="fl">400</span>, stepd2 <span class="op">=</span> <span class="fl">5</span>,                      <span class="co"># define optimization set for d2</span></span>
<span>   adj <span class="op">=</span> <span class="st">"both"</span>,                                             <span class="co"># choose both adjustment methods</span></span>
<span>   lambdamin <span class="op">=</span> <span class="fl">0.7</span>, lambdamax <span class="op">=</span> <span class="fl">1</span>, steplambda <span class="op">=</span> <span class="fl">0.05</span>,        <span class="co"># optimization set for multiplicative adjustment</span></span>
<span>   alphaCImin <span class="op">=</span> <span class="fl">0.1</span>, alphaCImax <span class="op">=</span> <span class="fl">0.5</span>, stepalphaCI <span class="op">=</span> <span class="fl">0.05</span>,   <span class="co"># optimization set for additive adjustment</span></span>
<span>   hrgomin <span class="op">=</span> <span class="fl">0.7</span>, hrgomax <span class="op">=</span> <span class="fl">0.9</span>, stephrgo <span class="op">=</span> <span class="fl">0.01</span>,            <span class="co"># define optimization set for HRgo</span></span>
<span>   alpha <span class="op">=</span> <span class="fl">0.05</span>, beta <span class="op">=</span> <span class="fl">0.1</span>, xi2 <span class="op">=</span> <span class="fl">0.7</span>, xi3 <span class="op">=</span> <span class="fl">0.7</span>,           <span class="co"># drug development planning parameters</span></span>
<span>   c2 <span class="op">=</span> <span class="fl">0.75</span>, c3 <span class="op">=</span> <span class="fl">1</span>, c02 <span class="op">=</span> <span class="fl">100</span>, c03 <span class="op">=</span> <span class="fl">150</span>,                  <span class="co"># define fixed and variable costs</span></span>
<span>   K <span class="op">=</span> <span class="cn">Inf</span>, N <span class="op">=</span> <span class="cn">Inf</span>, S <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,                               <span class="co"># set constraints</span></span>
<span>   steps1 <span class="op">=</span> <span class="fl">1</span>,  stepm1 <span class="op">=</span> <span class="fl">0.95</span>, stepl1 <span class="op">=</span> <span class="fl">0.85</span>,                <span class="co"># define boundary for  effect size categories</span></span>
<span>   b1 <span class="op">=</span> <span class="fl">1000</span>, b2 <span class="op">=</span> <span class="fl">2000</span>, b3 <span class="op">=</span> <span class="fl">3000</span>,                          <span class="co"># define expected benefits</span></span>
<span>   fixed <span class="op">=</span> <span class="cn">TRUE</span>,                                             <span class="co"># choose if  effects are fixed or random</span></span>
<span>   num_cl <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="interpreting-the-output">Interpreting the output<a class="anchor" aria-label="anchor" href="#interpreting-the-output"></a>
</h3>
<p>After setting all these input parameters and running the function,
let’s take a look at the output of the program.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span></span>
<span><span class="co">#&gt;     Method      u  Adj HRgo  d2  d3   d  n2  n3   n  pgo sProg   hr   K   N</span></span>
<span><span class="co">#&gt; 6 multipl. 587.18 0.95 0.87 210 451 661 300 644 944 0.86  0.72 0.75 Inf Inf</span></span>
<span><span class="co">#&gt; 9     add. 584.57 0.50 0.88 210 441 651 300 630 930 0.88  0.71 0.75 Inf Inf</span></span>
<span><span class="co">#&gt;      S  K2  K3 sProg1 sProg2 sProg3 steps1 stepm1 stepl1 alpha beta xi2 xi3 c02</span></span>
<span><span class="co">#&gt; 6 -Inf 325 773   0.08    0.3   0.33      1   0.95   0.85  0.05  0.1 0.7 0.7 100</span></span>
<span><span class="co">#&gt; 9 -Inf 325 761   0.09    0.3   0.33      1   0.95   0.85  0.05  0.1 0.7 0.7 100</span></span>
<span><span class="co">#&gt;   c03   c2 c3   b1   b2   b3</span></span>
<span><span class="co">#&gt; 6 150 0.75  1 1000 2000 3000</span></span>
<span><span class="co">#&gt; 9 150 0.75  1 1000 2000 3000</span></span></code></pre></div>
<p>The program returns output values for both adjustment methods. The
most important ones for the multiplicative method are:</p>
<ul>
<li>
<code>res$Adj</code> is the optimal multiplicative adjustment
parameter. In this setting, our optimal value is 0.95, indicating that a
slight bias adjustment leads to a higher utility.</li>
<li>
<code>res$d2</code> is the optimal number of events for phase II and
<code>res$d3</code> the resulting number of events for phase III. We see
that the optimal scenario requires 210 events in phase II and 451 events
in phase III, which correspond to 300 participants in phase II and 644
in phase III.</li>
<li>
<code>res$HRgo</code> is the optimal threshold value for the
go/no-go decision rule. We see that we need a hazard ratio of less than
0.87 in phase II in order to proceed to phase III.</li>
<li>
<code>res$u</code> is the expected utility of the program for the
optimal sample size and threshold value. In our case it amounts to
587.18, i.e we have an expected utility of 58 718 000$.</li>
</ul>
<p>For the additive method we get:</p>
<ul>
<li>
<code>res$Adj</code> is the optimal additive adjustment parameter.
In this setting, our optimal value is 0.5, indicating that no bias
adjustment leads to the highest utility. In this case, our results match
the results of the basic setting as can be verified <a href="https://sterniii3.github.io/drugdevelopR/articles/Time-to-event_outcomes.html">here</a>.</li>
<li>
<code>res$d2</code> is the optimal number of events for phase II and
<code>res$d3</code> the resulting number of events for phase III. We see
that the optimal scenario requires 210 events in phase II and 441 events
in phase III, which correspond to 300 participants in phase II and 630
in phase III.</li>
<li>
<code>res$HRgo</code> is the optimal threshold value for the
go/no-go decision rule. We see that we need a hazard ratio of less than
0.88 in phase II in order to proceed to phase III.</li>
<li>
<code>res$u</code> is the expected utility of the program for the
optimal sample size and threshold value. In our case it amounts to
584.57, i.e we have an expected utility of 58 457 000$.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="where-to-go-from-here">Where to go from here<a class="anchor" aria-label="anchor" href="#where-to-go-from-here"></a>
</h2>
<p>In this article we presented an example how methods to discount the
results of phase II can be included for the purpose of bias adjustment.
Note, that this example is not restricted to time-to-event endpoints but
can also be applied to binary and normally distributed endpoints using
the function <code>optimal_bias_binary</code> and
<code>optimal_bias_normal</code>. For more information on how to use the
package, see:</p>
<ul>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/introduction-to-drugdevelopR.html"><em>Introduction
to drugdevelopR:</em></a> See how the package works in a basic
example.</li>
<li>
<em>Different outcomes:</em> Apply it to <a href="https://sterniii3.github.io/drugdevelopR/articles/Binary_distributed_outcomes.html">binary
endpoints</a> and <a href="https://sterniii3.github.io/drugdevelopR/articles/Time-to-event_outcomes.html">time-to-event
endpoints</a>.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/Interpreting_Output.html"><em>Interpreting
the rest of the output:</em></a> Obtain further details on your drug
development program.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/Fixed_and_prior_distributions.html"><em>Fixed
or prior:</em></a> Model the assumed treatment effect on a prior
distribution.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/More_Parameters.html"><em>More
parameters:</em></a> Define custom effect size categories. Put
constraints on the optimization by defining maximum costs, the total
expected sample size of the program or the minimum expected probability
of a successful program. Define an expected difference in treatment
effect between phase II and III. Skip phase II.</li>
<li>
<em>Complex drug development programs:</em> Adapt to situations with
<a href="https://sterniii3.github.io/drugdevelopR/articles/Multitrial.html">multiple
phase III trials</a>, <a href="https://sterniii3.github.io/drugdevelopR/articles/Multiarm_Trials.html">multi-arm
trials</a>, or multiple endpoints.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/More_Parameters.html"><em>Parallel
computing:</em></a> Be faster at calculating the optimum by using
parallel computing.</li>
</ul>
<p>#References Kirby, S., Burke, J., Chuang-Stein, C., and Sin, C.
(2012). Discounting phase 2 results when planning phase 3 clinical
trials. Pharmaceutical Statistics, 11(5):373–385.</p>
<p>Wang, S.-J., Hung, H. J., and O’Neill, R. T. (2006). Adapting the
sample size planning of a phase III trial based on phase II data.
Pharmaceutical Statistics, 5(2):85–97.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Stella Preussler.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

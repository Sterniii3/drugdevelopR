<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="drugdevelopR">
<title>Fixed effects and prior distributions • drugdevelopR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fixed effects and prior distributions">
<meta property="og:description" content="drugdevelopR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">drugdevelopR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Bias_adjustment.html">Bias_adjustment</a>
    <a class="dropdown-item" href="../articles/Binary_distributed_outcomes.html">Binary Distributed Outcome Variables</a>
    <a class="dropdown-item" href="../articles/Fixed_and_prior_distributions.html">Fixed effects and prior distributions</a>
    <a class="dropdown-item" href="../articles/Interpreting_Output.html">Interpreting the Rest of the Output</a>
    <a class="dropdown-item" href="../articles/More_Parameters.html">More Parameters to Adapt to Specific Settings and Individual Needs</a>
    <a class="dropdown-item" href="../articles/Multiarm_Trials.html">Multiarm_Trials</a>
    <a class="dropdown-item" href="../articles/Multiple_Endpoints.html">Multiple_Endpoints</a>
    <a class="dropdown-item" href="../articles/Multitrial.html">Multitrial</a>
    <a class="dropdown-item" href="../articles/Time-to-event_outcomes.html">Time-to-event_outcomes</a>
    <a class="dropdown-item" href="../articles/introduction-to-drugdevelopR.html">Introduction to planning phase II and phase III trials with drugdevelopR</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Sterniii3/drugdevelopR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fixed effects and prior distributions</h1>
                        <h4 data-toc-skip class="author">Johannes
Cepicka</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Sterniii3/drugdevelopR/blob/HEAD/vignettes/Fixed_and_prior_distributions.Rmd" class="external-link"><code>vignettes/Fixed_and_prior_distributions.Rmd</code></a></small>
      <div class="d-none name"><code>Fixed_and_prior_distributions.Rmd</code></div>
    </div>

    
    
<p>Suppose we are planning a drug development program testing the
superiority of an experimental treatment over a control treatment. Our
drug development program consists of an exploratory phase II trial which
is, in case of promising results, followed by a confirmatory phase III
trial.</p>
<p>The drugdevelopR package enables us to optimally plan such programs
using a utility-maximizing approach. Up until now, we presented a very
basic example on how the package works in <a href="https://sterniii3.github.io/drugdevelopR/articles/introduction-to-drugdevelopR.html">Introduction
to planning phase II and phase III trials with drugdevelopR</a>. In this
article, we want to expand the basic setting and want to introduce you
to the modelling of the assumed treatment effect on a prior
distribution.</p>
<div class="section level2">
<h2 id="the-example-setting">The example setting<a class="anchor" aria-label="anchor" href="#the-example-setting"></a>
</h2>
<p>We are in the same setting as in the introduction, i.e. we suppose we
are developing a new tumor treatment, <em>exper</em>. The patient
variable that we want to investigate is the difference in tumor width
between the one-year visit and baseline. This is a normally distributed
outcome variable.</p>
<p>The parameters we insert into the function
<code>optimum_normal</code> are the same parameters we also inserted in
the basic setting. However this time, we set <code>fixed</code> =
<code>"FALSE"</code>, hence the assumed true treatment effect is not
fixed but follows a prior distribution. Again, we start by loading the
drugdevelopR package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Sterniii3/drugdevelopR" class="external-link">drugdevelopR</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: mvtnorm</span></span>
<span><span class="co">#&gt; Loading required package: doParallel</span></span>
<span><span class="co">#&gt; Loading required package: foreach</span></span>
<span><span class="co">#&gt; Loading required package: iterators</span></span>
<span><span class="co">#&gt; Loading required package: parallel</span></span>
<span><span class="co">#&gt; Loading required package: msm</span></span>
<span><span class="co">#&gt; Loading required package: cubature</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span></code></pre></div>
<div class="section level3">
<h3 id="parameters-of-the-prior-distribution">Parameters of the prior distribution<a class="anchor" aria-label="anchor" href="#parameters-of-the-prior-distribution"></a>
</h3>
<p>Additionally to the parameters in the baseline scenario with fixed
treatment effects, we now need further input parameters:</p>
<ul>
<li>Differing from the baseline scenario we now have not only one
treatment effect, but two: <code>Delta1</code> and <code>Delta2</code>.
The input parameter <code>Delta1</code> is the one we got from some
randomized controlled pilot trial that our team conducted earlier. Its
value is given as the standardized difference in means (<span class="math inline">\(\Delta=\frac{\mu_{contro} -
\mu_{exper}}{\sigma}\)</span>) and its value was determined to be 0.625.
However, we are not so sure about this result, as another research group
conducted a similar study and got an treatment effect of 0.9, which will
now be our value for <code>Delta2</code>. Of course, the choice of <span class="math inline">\(\Delta_1\)</span> and <span class="math inline">\(\Delta_2\)</span> need not be built on two
clinical studies, but can also be derived from different sources for
forming a prior belief, e.g. clinical experience.</li>
<li>We now have to add more information about the two experiments which
is done by the two additional parameters <code>in1</code> and
<code>in2</code>. We call these parameters the “amount of information”
and they refer to the number of participants which were used in the
study to determine the treatment effect. If our study was conducted with
300 participants the value for <code>in1</code> is set to be 300. Let’s
assume that the study of the other research group was conducted with 600
participants, so the parameter value for <code>in2</code> is 600.</li>
<li>Now, a weight parameter <code>w</code> has to be defined, that
allows us to weigh the two treatment effects. If we want to trust our
results more, than we can set a higher parameter value for w (Note w has
to be between 0 and 1, a parameter value of 1 would put all the weight
on our results and none on the results of the second study), if we think
the results of the other group are more reliable we reduce the value for
w, thus putting more weight on <code>Delta2</code>. Note that by
exchanging the values of <code>Delta1</code> and <code>Delta2</code>
(and the corresponding values for <code>in1</code> and <code>in2</code>)
and setting <span class="math inline">\(w_{new} = 1 - w_{old}\)</span>
our final results will not change. In our case, we want to put more
trust on our results and thus set the parameter <code>w</code> to be
0.6. Setting the weight to <span class="math inline">\(1\)</span> would
effectively mean ignoring the second treatment effect, which is also
possible.</li>
<li>The prior distribution used in the package is the sum of two
truncated normal distributions. Hence, we need truncation values
<code>a</code> as the lower boundary for the truncation and
<code>b</code> as the upper boundary. In our case we set
<code>a = 0.25</code> and <code>b = 0.75</code>.</li>
</ul>
<p>The prior distribution for the standardized true difference in means
is then given by <span class="math inline">\(\Delta ∼ w ·
\mathcal{N}^t_{[0.25,0.75]} (0.625, 4/300) + (1 − w) ·
\mathcal{N}^t_{[0.25,0.75]} (0.9, 4/600)\)</span> where <span class="math inline">\(N^t_{[a,b]} (\mu, \sigma^2)\)</span> denotes the
truncated normal distribution with mean <span class="math inline">\(\mu\)</span>, variance <span class="math inline">\(\sigma^2\)</span>, truncated below at a and above
at b. To see how different input values change the prior distribution we
refer to the <a href="https://web.imbi.uni-heidelberg.de/prior/" class="external-link">Shiny
App</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimal_normal.html">optimal_normal</a></span><span class="op">(</span>Delta1 <span class="op">=</span> <span class="fl">0.625</span>, Delta2 <span class="op">=</span> <span class="fl">0.8</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># treatment effect</span></span>
<span>                       n2min <span class="op">=</span> <span class="fl">20</span>, n2max <span class="op">=</span> <span class="fl">400</span>, <span class="co"># sample size region</span></span>
<span>                       stepn2 <span class="op">=</span> <span class="fl">4</span>, <span class="co"># sample size step size</span></span>
<span>                       kappamin <span class="op">=</span> <span class="fl">0.02</span>, kappamax <span class="op">=</span> <span class="fl">0.2</span>, <span class="co"># threshold region</span></span>
<span>                       stepkappa <span class="op">=</span> <span class="fl">0.02</span>, <span class="co"># threshold step size</span></span>
<span>                       c2 <span class="op">=</span> <span class="fl">0.675</span>, c3 <span class="op">=</span> <span class="fl">0.72</span>, <span class="co"># maximal total trial costs</span></span>
<span>                       c02 <span class="op">=</span> <span class="fl">15</span>, c03 <span class="op">=</span> <span class="fl">20</span>, <span class="co"># maximal per-patient costs</span></span>
<span>                       b1 <span class="op">=</span> <span class="fl">3000</span>, b2 <span class="op">=</span> <span class="fl">8000</span>, b3 <span class="op">=</span> <span class="fl">10000</span>, <span class="co"># gains for patients</span></span>
<span>                       alpha <span class="op">=</span> <span class="fl">0.05</span>, <span class="co"># significance level</span></span>
<span>                       beta <span class="op">=</span> <span class="fl">0.1</span>, <span class="co"># 1 - power</span></span>
<span>                       w <span class="op">=</span> <span class="fl">0.6</span>, in1 <span class="op">=</span> <span class="fl">300</span>, in2 <span class="op">=</span> <span class="fl">600</span>, <span class="co">#weight and amount of information</span></span>
<span>                       a <span class="op">=</span> <span class="fl">0.25</span>, b <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="co">#truncation values</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interpreting-the-output">Interpreting the output<a class="anchor" aria-label="anchor" href="#interpreting-the-output"></a>
</h3>
<p>After setting all these input parameters and running the function,
let’s take a look at the output of the program.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span></span>
<span><span class="co">#&gt;         u Kappa n2  n3   n  pgo sProg   w Delta1 Delta2 in1 in2    a    b   K</span></span>
<span><span class="co">#&gt; 1 3473.81  0.06 76 158 234 0.99  0.85 0.6  0.625    0.9 300 600 0.25 0.75 Inf</span></span>
<span><span class="co">#&gt;   K2  K3 sProg1 sProg2 sProg3 steps1 stepm1 stepl1 alpha beta c02 c03    c2</span></span>
<span><span class="co">#&gt; 1 66 134   0.64    0.2   0.02      0    0.5    0.8  0.05  0.1  15  20 0.675</span></span>
<span><span class="co">#&gt;     c3   b1   b2    b3 gamma</span></span>
<span><span class="co">#&gt; 1 0.72 3000 8000 10000     0</span></span></code></pre></div>
<p>The program returns a total of thirteen values and the input values.
Once again we will only focus at the most important ones:</p>
<ul>
<li>
<code>res$n2</code> is the optimal sample size for phase II and
<code>res$n3</code> the resulting sample size for phase III. We see that
the optimal scenario requires 76 participants in phase II and 158
participants in phase III. The number of participants in both phases was
reduced compared to the setting with a fixed treatment effect.</li>
<li>
<code>res$Kappa</code> is the optimal threshold value for the
go/no-go decision rule. We see that we need a treatment effect of more
than 0.06 in phase II in order to proceed to phase III, which is the
same as in the baseline scenario.</li>
<li>
<code>res$u</code> is the expected utility of the program for the
optimal sample size and threshold value. In our case it amounts to
3473.81, i.e we have an expected utility of 347 381 000$. This is a
6.56% increase over the scenario without the prior distribution. The
increase in the expected utility can be attributed to the additional
weight which was put on the second treatment effect <code>Delta2</code>,
which was more promising than our treatment effect.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="where-to-go-from-here">Where to go from here<a class="anchor" aria-label="anchor" href="#where-to-go-from-here"></a>
</h2>
<p>This tutorial explains how to use the parameters needed for the prior
distribution when setting the parameter <code>fixed</code> to be
<code>"FALSE"</code>.</p>
<p>For more information on how to use the package, see:</p>
<ul>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/introduction-to-drugdevelopR.html"><em>Introduction
to drugdevelopR:</em></a> See how the package works in a basic
example.</li>
<li>
<em>Different outcomes:</em> Apply it to <a href="https://sterniii3.github.io/drugdevelopR/articles/Binary_distributed_outcomes.html">binary
endpoints</a> and time-to-event endpoints.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/Interpreting_Output.html"><em>Interpreting
the rest of the output:</em></a> Obtain further details on your drug
development program.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/More_Parameters.html"><em>More
parameters:</em></a> Define custom effect size categories. Put
constraints on the optimization by defining maximum costs, the total
expected sample size of the program or the minimum expected probability
of a successful program. Define an expected difference in treatment
effect between phase II and III. Skip phase II.</li>
<li>
<em>Complex drug development programs:</em> Adapt to situations with
biased effect estimators, multiple phase III trials, multi-arm trials,
or multiple endpoints.</li>
<li>
<em>Parallel computing:</em> Be faster at calculating the optimum by
using parallel computing.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Stella Preussler.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

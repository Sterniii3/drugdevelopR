<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fixed effect estimates and prior distributions • drugdevelopR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fixed effect estimates and prior distributions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">drugdevelopR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Introduction-to-drugdevelopR.html">Introduction to planning phase II and phase III trials with drugdevelopR</a></li>
    <li><a class="dropdown-item" href="../articles/Package_validation.html">Package validation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Sterniii3/drugdevelopR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fixed effect estimates and prior distributions</h1>
                        <h4 data-toc-skip class="author">Johannes
Cepicka</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Sterniii3/drugdevelopR/blob/v1.0.2-cran/vignettes/Fixed_and_prior_distributions.Rmd" class="external-link"><code>vignettes/Fixed_and_prior_distributions.Rmd</code></a></small>
      <div class="d-none name"><code>Fixed_and_prior_distributions.Rmd</code></div>
    </div>

    
    
<p>Suppose we are planning a drug development program testing the
superiority of an experimental treatment over a control treatment. Our
drug development program consists of an exploratory phase II trial which
is, in case of promising results, followed by a confirmatory phase III
trial.</p>
<p>The drugdevelopR package enables us to optimally plan such programs
using a utility-maximizing approach. Up until now, we presented a very
basic example on how the package works in <a href="https://sterniii3.github.io/drugdevelopR/articles/Introduction-to-drugdevelopR.html">Introduction
to planning phase II and phase III trials with drugdevelopR</a>. In this
article, we want to expand the basic setting and want to introduce you
to the modelling of the assumed treatment effect on a prior
distribution.</p>
<div class="section level2">
<h2 id="the-example-setting">The example setting<a class="anchor" aria-label="anchor" href="#the-example-setting"></a>
</h2>
<p>We are in the same setting as in the introduction, i.e. we suppose we
are developing a new tumor treatment, <em>exper</em>. The patient
variable that we want to investigate is the difference in tumor width
between the one-year visit and baseline. This is a normally distributed
outcome variable.</p>
<p>The parameters we insert into the function
<code>optimum_normal</code> are the same parameters we also inserted in
the basic setting. However this time, we set <code>fixed</code> =
<code>"FALSE"</code>, hence the assumed true treatment effect is not
fixed but follows a prior distribution. Again, we start by loading the
drugdevelopR package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Sterniii3/drugdevelopR" class="external-link">drugdevelopR</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: doParallel</span></span>
<span><span class="co">#&gt; Loading required package: foreach</span></span>
<span><span class="co">#&gt; Loading required package: iterators</span></span>
<span><span class="co">#&gt; Loading required package: parallel</span></span></code></pre></div>
<div class="section level3">
<h3 id="parameters-of-the-prior-distribution">Parameters of the prior distribution<a class="anchor" aria-label="anchor" href="#parameters-of-the-prior-distribution"></a>
</h3>
<p>Additionally to the parameters in the baseline scenario with fixed
treatment effects, we now need further input parameters:</p>
<ul>
<li>Differing from the baseline scenario we now have not only one
treatment effect, but two: <code>Delta1</code> and <code>Delta2</code>.
The input parameter <code>Delta1</code> is the one we got from some
randomized controlled pilot trial that our team conducted earlier. Its
value is given as the standardized difference in means
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mo>=</mo><mfrac><mrow><msub><mi>μ</mi><mrow><mi>c</mi><mi>o</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>o</mi></mrow></msub><mo>−</mo><msub><mi>μ</mi><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mi>e</mi><mi>r</mi></mrow></msub></mrow><mi>σ</mi></mfrac></mrow><annotation encoding="application/x-tex">\Delta=\frac{\mu_{contro} - \mu_{exper}}{\sigma}</annotation></semantics></math>)
and its value was determined to be 0.625. However, we are not so sure
about this result, as another research group conducted a similar study
and got an treatment effect of 0.9, which will now be our value for
<code>Delta2</code>. Of course, the choice of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\Delta_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\Delta_2</annotation></semantics></math>
need not be built on two clinical studies, but can also be derived from
different sources for forming a prior belief, e.g. clinical
experience.</li>
<li>We now have to specify how sure we are about the two prior beliefs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\Delta_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\Delta_2</annotation></semantics></math>.
This is done by the two additional parameters <code>in1</code> and
<code>in2</code>. We call these parameters the “amount of information”.
They refer to the sample sizes of the studies on which we base our prior
beliefs. If our pilot study was conducted with 300 participants, the
value for <code>in1</code> is set to be 300. Let’s assume that the study
of the other research group was conducted with 600 participants, so the
parameter value for <code>in2</code> is 600. The higher amount of
information, the lower the variance we attribute to that prior
belief.</li>
<li>Now, a weight parameter <code>w</code> has to be defined, that
allows us to weigh the two treatment effects. If we want to trust our
results more, than we can set a higher parameter value for
<code>w</code>. (Note that <code>w</code> has to be between 0 and 1, a
parameter value of 1 would put all the weight on our results and none on
the results of the second study). If we think the results of the other
group are more reliable we reduce the value for w, thus putting more
weight on <code>Delta2</code>. Note that by exchanging the values of
<code>Delta1</code> and <code>Delta2</code> (and the corresponding
values for <code>in1</code> and <code>in2</code>) and setting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>w</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{new} = 1 - w_{old}</annotation></semantics></math>
our final results will not change. In our case, we want to put more
trust on our results and thus set the parameter <code>w</code> to be
0.6. Setting the weight to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
would effectively mean ignoring the second treatment effect, which is
also possible.</li>
<li>The prior distribution used in the package is the sum of two
truncated normal distributions. Hence, we need truncation values
<code>a</code> as the lower boundary for the truncation and
<code>b</code> as the upper boundary. In our case we set
<code>a = 0.25</code> and <code>b = 0.75</code>.</li>
</ul>
<p>The prior distribution for the standardized true difference in means
is then given by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mo>∼</mo><mi>w</mi><mo>·</mo><msubsup><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>0.25</mn><mo>,</mo><mn>0.75</mn><mo stretchy="true" form="postfix">]</mo></mrow><mi>t</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.625</mn><mo>,</mo><mn>4</mn><mi>/</mi><mn>300</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>·</mo><msubsup><mi>𝒩</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>0.25</mn><mo>,</mo><mn>0.75</mn><mo stretchy="true" form="postfix">]</mo></mrow><mi>t</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.9</mn><mo>,</mo><mn>4</mn><mi>/</mi><mn>600</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Delta ∼ w · \mathcal{N}^t_{[0.25,0.75]} (0.625, 4/300) + (1 − w) · \mathcal{N}^t_{[0.25,0.75]} (0.9, 4/600)</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>N</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">]</mo></mrow><mi>t</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>μ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">N^t_{[a,b]} (\mu, \sigma^2)</annotation></semantics></math>
denotes the truncated normal distribution with mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>,
variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>σ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math>,
truncated below at a and above at b. To see how different input values
change the prior distribution we refer to the <a href="https://web.imbi.uni-heidelberg.de/prior/" class="external-link">Shiny app</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optimal_normal.html">optimal_normal</a></span><span class="op">(</span>Delta1 <span class="op">=</span> <span class="fl">0.625</span>, Delta2 <span class="op">=</span> <span class="fl">0.8</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># treatment effect</span></span>
<span>                       n2min <span class="op">=</span> <span class="fl">20</span>, n2max <span class="op">=</span> <span class="fl">400</span>, <span class="co"># sample size region</span></span>
<span>                       stepn2 <span class="op">=</span> <span class="fl">4</span>, <span class="co"># sample size step size</span></span>
<span>                       kappamin <span class="op">=</span> <span class="fl">0.02</span>, kappamax <span class="op">=</span> <span class="fl">0.2</span>, <span class="co"># threshold region</span></span>
<span>                       stepkappa <span class="op">=</span> <span class="fl">0.02</span>, <span class="co"># threshold step size</span></span>
<span>                       c2 <span class="op">=</span> <span class="fl">0.675</span>, c3 <span class="op">=</span> <span class="fl">0.72</span>, <span class="co"># maximal total trial costs</span></span>
<span>                       c02 <span class="op">=</span> <span class="fl">15</span>, c03 <span class="op">=</span> <span class="fl">20</span>, <span class="co"># maximal per-patient costs</span></span>
<span>                       b1 <span class="op">=</span> <span class="fl">3000</span>, b2 <span class="op">=</span> <span class="fl">8000</span>, b3 <span class="op">=</span> <span class="fl">10000</span>, <span class="co"># gains for patients</span></span>
<span>                       alpha <span class="op">=</span> <span class="fl">0.025</span>, <span class="co"># significance level</span></span>
<span>                       beta <span class="op">=</span> <span class="fl">0.1</span>, <span class="co"># 1 - power</span></span>
<span>                       w <span class="op">=</span> <span class="fl">0.6</span>, in1 <span class="op">=</span> <span class="fl">300</span>, in2 <span class="op">=</span> <span class="fl">600</span>, <span class="co">#weight and amount of information</span></span>
<span>                       a <span class="op">=</span> <span class="fl">0.25</span>, b <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="co">#truncation values</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interpreting-the-output">Interpreting the output<a class="anchor" aria-label="anchor" href="#interpreting-the-output"></a>
</h3>
<p>After setting all these input parameters and running the function,
let’s take a look at the output of the program.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span></span>
<span><span class="co">#&gt; Optimization result:</span></span>
<span><span class="co">#&gt;  Utility: 3147.32</span></span>
<span><span class="co">#&gt;  Sample size:</span></span>
<span><span class="co">#&gt;    phase II: 80, phase III: 188, total: 268</span></span>
<span><span class="co">#&gt;  Probability to go to phase III: 0.99</span></span>
<span><span class="co">#&gt;  Total cost:</span></span>
<span><span class="co">#&gt;    phase II: 69, phase III: 155, cost constraint: Inf</span></span>
<span><span class="co">#&gt;  Fixed cost:</span></span>
<span><span class="co">#&gt;    phase II: 15, phase III: 20</span></span>
<span><span class="co">#&gt;  Variable cost per patient:</span></span>
<span><span class="co">#&gt;    phase II: 0.675, phase III: 0.72</span></span>
<span><span class="co">#&gt;  Effect size categories (expected gains):</span></span>
<span><span class="co">#&gt;   small: 0 (3000), medium: 0.5 (8000), large: 0.8 (10000)</span></span>
<span><span class="co">#&gt;  Success probability: 0.85</span></span>
<span><span class="co">#&gt;  Joint probability of success and observed effect of size ... in phase III:</span></span>
<span><span class="co">#&gt;    small: 0.68, medium: 0.16, large: 0.01</span></span>
<span><span class="co">#&gt;  Significance level: 0.025</span></span>
<span><span class="co">#&gt;  Targeted power: 0.9</span></span>
<span><span class="co">#&gt;  Decision rule threshold: 0.06 [Kappa] </span></span>
<span><span class="co">#&gt;  Parameters of the prior distribution: </span></span>
<span><span class="co">#&gt;    Delta1: 0.625, Delta2: 0.9, in1: 300, in2: 600,</span></span>
<span><span class="co">#&gt;    a: 0.25, b: 0.75, w: 0.6</span></span>
<span><span class="co">#&gt;  Treatment effect offset between phase II and III: 0 [gamma]</span></span></code></pre></div>
<p>The program returns a total of thirteen values and the input values.
Once again, we will only focus at the most important ones:</p>
<ul>
<li>
<code>res$n2</code> is the optimal sample size for phase II and
<code>res$n3</code> the resulting sample size for phase III. We see that
the optimal scenario requires 80 participants in phase II and 188
participants in phase III. The number of participants in both phases was
reduced compared to the setting with a fixed treatment effect.</li>
<li>
<code>res$Kappa</code> is the optimal threshold value for the
go/no-go decision rule. We see that we need a treatment effect of more
than 0.06 in phase II in order to proceed to phase III, which is the
same as in the baseline scenario.</li>
<li>
<code>res$u</code> is the expected utility of the program for the
optimal sample size and threshold value. In our case it amounts to
3147.32, i.e. we have an expected utility of 314 732 000$. This is a
6.83% increase over the scenario without the prior distribution. The
increase in the expected utility can be attributed to the additional
weight which was put on the second treatment effect <code>Delta2</code>,
which was more promising than our treatment effect.</li>
</ul>
<p>Of course, the differences in the output values compared to the fixed
setting heavily depend on the choice of the prior.</p>
</div>
</div>
<div class="section level2">
<h2 id="prior-distributions-for-time-to-event-outcomes">Prior distributions for time-to-event outcomes<a class="anchor" aria-label="anchor" href="#prior-distributions-for-time-to-event-outcomes"></a>
</h2>
<p>Note that in the setting of <a href="https://sterniii3.github.io/drugdevelopR/articles/Time-to-event_outcomes.html">time-to-event
outcomes</a>, the following input parameters have to be specified, which
differ from the setting with normally distributed outcomes:</p>
<ul>
<li>Instead of the parameters <code>in1</code> and <code>in2</code> for
the “amount of information”, we have to use the parameters
<code>id1</code> and <code>id2</code> which represent the “number of
events”. They refer to the number of events which were observed in the
study to determine the treatment effect. If in our study 210 events
could be observed, then the value for <code>id1</code> is set to be 210.
If we assume assume that in the study of the other research group 420
events could be observed, the parameter value for <code>id2</code> is
420.</li>
<li>Moreover, we do not need truncation values, i.e. values for the
parameters <code>a</code> and <code>b</code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="where-to-go-from-here">Where to go from here<a class="anchor" aria-label="anchor" href="#where-to-go-from-here"></a>
</h2>
<p>This tutorial explains how to use the parameters needed for the prior
distribution when setting the parameter <code>fixed</code> to be
<code>"FALSE"</code>.</p>
<p>For more information on how to use the package, see:</p>
<ul>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/Introduction-to-drugdevelopR.html"><em>Introduction
to drugdevelopR:</em></a> See how the package works in a basic
example.</li>
<li>
<em>Different outcomes:</em> Apply it to <a href="https://sterniii3.github.io/drugdevelopR/articles/Binary_outcomes.html">binary
endpoints</a> and <a href="https://sterniii3.github.io/drugdevelopR/articles/Time-to-event_outcomes.html">time-to-event
endpoints</a>.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/Interpreting_Output.html"><em>Interpreting
the rest of the output:</em></a> Obtain further details on your drug
development program.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/More_Parameters.html"><em>More
parameters:</em></a> Define custom effect size categories. Put
constraints on the optimization by defining maximum costs, the total
expected sample size of the program or the minimum expected probability
of a successful program. Define an expected difference in treatment
effect between phase II and III. Skip phase II.</li>
<li>
<em>Complex drug development programs:</em> Adapt to situations with
<a href="https://sterniii3.github.io/drugdevelopR/articles/Bias_adjustment.html">biased
effect estimators</a>, <a href="https://sterniii3.github.io/drugdevelopR/articles/Multitrial.html">multiple
phase III trials</a>, <a href="https://sterniii3.github.io/drugdevelopR/articles/Multiarm_Trials.html">multi-arm
trials</a>, or <a href="https://sterniii3.github.io/drugdevelopR/articles/Multiple_Endpoints.html">multiple
endpoints</a>.</li>
<li>
<a href="https://sterniii3.github.io/drugdevelopR/articles/More_Parameters.html#parallel-computing"><em>Parallel
computing:</em></a> Be faster at calculating the optimum by using
parallel computing.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Stella Erdmann, Johannes Cepicka, Marietta Kirchner, Meinhard Kieser, Lukas D. Sauer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
